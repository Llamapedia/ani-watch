import{_ as H}from"./Dt2ISLFS.js";import{n as M,N as x,r as h,L as I,q as E,B as V,o as _,c as k,a as o,b as j,w as R,x as D,z as N,s as p,E as U,O as z,d as B,v as O,h as T,y as P,F as q,A as C,t as F,M as J,P as $,I as K,j as Q,J as W,Q as A,R as G}from"./Dejc2vlv.js";const X="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M5.52%2019c.64-2.2%201.84-3%203.22-3h6.52c1.38%200%202.58.8%203.22%203'/%3e%3ccircle%20cx='12'%20cy='10'%20r='3'/%3e%3ccircle%20cx='12'%20cy='12'%20r='10'/%3e%3c/svg%3e",Y="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M20%2021v-2a4%204%200%200%200-4-4H8a4%204%200%200%200-4%204v2'%3e%3c/path%3e%3ccircle%20cx='12'%20cy='7'%20r='4'%3e%3c/circle%3e%3c/svg%3e",Z="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3ccircle%20cx='12'%20cy='12'%20r='3'%3e%3c/circle%3e%3cpath%20d='M19.4%2015a1.65%201.65%200%200%200%20.33%201.82l.06.06a2%202%200%200%201%200%202.83%202%202%200%200%201-2.83%200l-.06-.06a1.65%201.65%200%200%200-1.82-.33%201.65%201.65%200%200%200-1%201.51V21a2%202%200%200%201-2%202%202%202%200%200%201-2-2v-.09A1.65%201.65%200%200%200%209%2019.4a1.65%201.65%200%200%200-1.82.33l-.06.06a2%202%200%200%201-2.83%200%202%202%200%200%201%200-2.83l.06-.06a1.65%201.65%200%200%200%20.33-1.82%201.65%201.65%200%200%200-1.51-1H3a2%202%200%200%201-2-2%202%202%200%200%201%202-2h.09A1.65%201.65%200%200%200%204.6%209a1.65%201.65%200%200%200-.33-1.82l-.06-.06a2%202%200%200%201%200-2.83%202%202%200%200%201%202.83%200l.06.06a1.65%201.65%200%200%200%201.82.33H9a1.65%201.65%200%200%200%201-1.51V3a2%202%200%200%201%202-2%202%202%200%200%201%202%202v.09a1.65%201.65%200%200%200%201%201.51%201.65%201.65%200%200%200%201.82-.33l.06-.06a2%202%200%200%201%202.83%200%202%202%200%200%201%200%202.83l-.06.06a1.65%201.65%200%200%200-.33%201.82V9a1.65%201.65%200%200%200%201.51%201H21a2%202%200%200%201%202%202%202%202%200%200%201-2%202h-.09a1.65%201.65%200%200%200-1.51%201z'%3e%3c/path%3e%3c/svg%3e",ee="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M10%203H6a2%202%200%200%200-2%202v14c0%201.1.9%202%202%202h4M16%2017l5-5-5-5M19.8%2012H9'/%3e%3c/svg%3e",te={class:"navbar"},oe={class:"navbar-elements"},se=["src"],ae={class:"right-side"},ne={key:0,class:"dropdown"},ce=o("img",{src:Y,alt:""},null,-1),le=o("a",{href:"#",class:"dropdown-content"},[o("img",{src:Z,alt:""}),B(" Settings ")],-1),re=o("img",{src:ee,alt:""},null,-1),ie=M({__name:"PageNav",setup(L){const n=x("themes"),c=h(),l=h({}),g=h(!1),m=h(""),r=h(!1),s=I(),a=x("themeDomain"),e=x("selectedTheme");E(()=>{u()});function t(){s.push(`/search/${m.value}`)}async function u(){const i=V.get("access_token"),d=`
            query {
                Viewer {
                    name
                    avatar {
                        large
                    }
                }
            }
        `,v={},f=await fetch("https://graphql.anilist.co",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({query:d,variables:v})});if(f.status===200){const b=await f.json();console.log(b),l.value=b.data.Viewer,c.value.src=b.data.Viewer.avatar.large,g.value=!0}}const y=()=>{V.remove("access_token"),window.location.reload()},w=()=>{if(e.value.id==="default"||!n)return"/res/logo/default.png";for(const i of Object.values(n.value))if(i.id===e.value.id)return i.logo?`${a.value}/res/logo/${i.logo}.png`:"/res/logo/default.png"};return(i,d)=>{const v=H;return _(),k("nav",te,[o("div",oe,[j(v,{to:"/",class:"logo"},{default:R(()=>[o("img",{src:w(),class:"logo"},null,8,se)]),_:1}),o("div",ae,[D(o("input",{type:"search",placeholder:"Search",class:"search-bar","onUpdate:modelValue":d[0]||(d[0]=f=>U(m)?m.value=f:null),onKeyup:z(t,["enter"])},null,544),[[N,p(m)]]),o("div",{class:"account-icon-container",onMouseover:d[1]||(d[1]=f=>r.value=!0),onMouseleave:d[2]||(d[2]=f=>r.value=!1)},[o("img",{ref_key:"usericon",ref:c,src:X,alt:"Account",class:"account-icon",width:"32",height:"32"},null,512),p(g)&&p(r)?(_(),k("div",ne,[j(v,{to:"/profile",class:"dropdown-content"},{default:R(()=>[ce,B(" Profile ")]),_:1}),le,o("a",{onClick:y,class:"dropdown-content"},[re,B(" Logout ")])])):O("",!0)],32)])])])}}}),de={class:"footer"},ue={class:"theme-selector"},he=["value"],ge=o("p",null," We are not responsible for the content on this website. All rights belong to anilist and malsync. ",-1),me=M({__name:"PageFooter",setup(L){const n=x("themes"),c=x("selectedTheme"),l=h(),g=x("themeDomain");T(c,(r,s)=>{l.value=r.id});const m=()=>{for(const s in n.value)n.value[s].id===l.value&&(c.value=n.value[s]);localStorage.setItem("theme",c.value.id);const r=`${g.value}/res/background/${c.value.id}.png`;fetch(r).then(async s=>{if(s.ok)try{const a=await caches.open("riju-cache-v1"),e=await a.keys();for(const t of e)await a.delete(t);await a.put(r,s),console.log("New image cached successfully")}catch(a){console.error("Error caching image:",a)}}).catch(s=>{console.error("Error fetching theme image",s)})};return E(()=>{l.value=localStorage.getItem("theme")||"default"}),(r,s)=>(_(),k("footer",de,[o("div",ue,[D(o("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>U(l)?l.value=a:null),onChange:m},[(_(!0),k(q,null,C(p(n),(a,e)=>(_(),k("option",{value:a.id,key:e},F(a.name),9,he))),128))],544),[[P,p(l)]]),o("button",{onClick:s[1]||(s[1]=a=>("navigateTo"in r?r.navigateTo:p(J))("/themes"))},"Manage Themes")]),ge]))}}),ve=o("img",{alt:"Background"},null,-1),fe=[ve],pe={class:"page-content"},ke=M({__name:"default",setup(L){const n=h(null),c=h({id:"default"});$("selectedTheme",c);const l=h("");$("themeDomain",l);const g=h({});T(l,(e,t)=>{e!==t&&s()}),T(g,(e,t)=>{e!==t&&(c.value.id=localStorage.getItem("theme")||"default",a())}),T(c,(e,t)=>{e!==t&&a()}),$("themes",g),$("themeDomain",l),K(()=>{l.value=localStorage.getItem("themeDomain")||"",s()}),E(async()=>{const e=h(document.body),t=new ResizeObserver(u=>{for(let y of u)y.target===e.value&&r()});e.value&&t.observe(e.value),window.addEventListener("resize",r),Q(()=>{window.removeEventListener("resize",r),e.value&&t.unobserve(e.value),t.disconnect()})});const m=W(()=>{var e,t;return((e=c.value)==null?void 0:e.viginette)==="light"?{"--brightness":"1.5"}:((t=c.value)==null?void 0:t.viginette)==="none"?{"--brightness":"1"}:{"--brightness":"0.5"}}),r=()=>{const e=document.documentElement.scrollHeight>window.innerHeight;!e&&n.value?setTimeout(()=>{e===document.documentElement.scrollHeight>window.innerHeight&&n.value.classList.add("page-bg-single")},1e3):n.value&&n.value.classList.remove("page-bg-single")},s=async()=>{fetch(`${l.value}/themes.json`).then(e=>e.json()).then(e=>g.value=e).catch(e=>console.error(e))},a=async()=>{var e,t;try{const u=`${l.value}/res/background/${c.value.id}.png`,w=await(await caches.open("riju-cache-v1")).match(u);if(w){console.log("Image retrieved from cache:",u);const i=URL.createObjectURL(await w.blob()),d=(e=n.value)==null?void 0:e.querySelectorAll("img");d&&d.forEach(async v=>{v.src=i})}else{console.log("No cached image found, fetching from network..."),console.log("Image URL:",u);const i=await fetch(u);if(i.ok){const d=await caches.open("riju-cache-v1"),v=await d.keys();for(const S of v)await d.delete(S);d.put(u,i.clone()),console.log("Image fetched from network and cached.");const f=URL.createObjectURL(await i.blob()),b=(t=n.value)==null?void 0:t.querySelectorAll("img");b&&b.forEach(async S=>{S.src=f})}else console.error("Failed to fetch image:",i.status)}}catch(u){console.error("Error retrieving image from cache:",u)}};return(e,t)=>{var w;const u=ie,y=me;return _(),k("div",{class:"page",style:A(`background: ${((w=p(c))==null?void 0:w.id)=="default"?"#333":""}`)},[o("div",{class:"page-bg",ref_key:"pageBg",ref:n,style:A(p(m))},[(_(),k(q,null,C(9,i=>o("div",{class:"page-bg-img",key:i},fe)),64))],4),j(u),o("div",pe,[G(e.$slots,"default")]),j(y)],4)}}});export{ke as default};
